#Server1000
server_name = "Server1000"
require 'socket'        
currentDir = File.join(Dir.pwd,server_name)	#This is this represents the folder that this server has access to.
port = 1000									#Arbitrary port for Storage Server
server = TCPServer.new(port)   
puts "Storage ServerCreated on port: #{port}"
loop {                    # Servers run forever
  
	Thread.start(server.accept) do |client|
    
	#Process incoming request from client
	requested_file = client.gets
	puts "Received message from Client: #{requested_file}"
	filename = requested_file.partition('_').last.delete!("\n")	#remove return character from string
	puts "Current Dir: #{currentDir}"
	#List of all Folders accessible server - scope is the Server1000 folder .
	system_folders = Dir.entries(currentDir).select {|entry| File.join(currentDir,entry) and !(entry =='.' || entry == '..') }
	system_folders.each do |files|
		
		####Checking if the file exists from the server perspective!!!!!!!!!!!!!
		
		puts "File: #{files}"
		puts "f1#{File.join(currentDir,requested_file)}"
		#puts "f2#{File.join(currentDir,filename)}"
		
		file_exist = File.exists?(File.join(currentDir,requested_file))#flag to determine if file exists
		puts "#{filename} exists (True/False):  #{file_exist}"
		
	end
	
	
	
	end
	
	
	
	#puts "Disconnecting From Client..."
    #client.close                # Disconnect from the client
	#puts "Connection Closed!"
  
}