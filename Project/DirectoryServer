#Directory Server

require 'socket'                # Get sockets from stdlib
currentDir = Dir.pwd			#Current Directory 
port = 2010
server = TCPServer.new(port)   	# Socket to listen on port 2010
puts "Directory Server Created on #{port}"
loop {                          # Servers run forever
  Thread.start(server.accept) do |client|
    #files = entries(currentDir)
	Dir.foreach(currentDir) {|x| puts "Got #{x}" } #list all files in current dirctory
		
	message = client.gets
		
	puts "Received message from Client: #{message}"
	filename = message.partition('_').last.delete!("\n")	#remove return character from string
	file_exist = File.exists?(File.join(currentDir,filename))
		
	puts "#{filename} exists (True/False):  #{file_exist}"
	if file_exist
		puts "File is in the folder"
	
	else 
		puts "File NOT in folder"
	end
    client.close                # Disconnect from the client
  end
}